\subsection{Two-way communication in the bearberry simulation}
\label{sec:bearberry}

\citet{salemaa:02}  have  studied  the  growth  habits,  axillary  bud
activation  and branching architecture  of the  horizontally spreading
clonal shrub  bearberry (\it Arctostaphylos uva-ursi  \rm L.)  growing
in  South Western  Finland in  varying pollution,  nutrient  and light
levels.  They have designed an L system model to study the qualitative
features of  the branching patterns of bearberry  by simulation.  Here
their bearberry  model growing  in sandpit is  realized in such  a way
that a  collition detection  algorithm can detect  if a  clonal branch
blockades the growth  space of an active bud.  This  also serves as an
example  of a  stochastic  L  system \citep{pp:90}  and  about how  to
implement global sensitivity \citep{kurth:94} in LIGNUM.

In their  L system model  for bearberry \citep{salemaa:02},  the plant
grows horizontally and consists of annual growth units bearing lateral
buds  and one apical  bud.  The  buds are  divided into  dominant (D),
subdominant  (SD) and nondominant  (ND) types  \citep{remphrey:83}.  A
living bud  produces a shoot  of its own  type.  Axillary buds  have a
time delay before they release and produce a shoot.

For  the  implementation in  L,  define  module  $B(T,S,C)$ where  $T$
denotes  the bud  type,  $S$ its  status,  i.e. the  time left  before
release, and $C$ collision.   The module definition for $B$ determines
the  lengths of  the  shoots produced,  branching  angles for  lateral
shoots forking  off alternately to the  left or to the  right, and the
number of  axillary buds  produced.  In general,  D shoots  are longer
than SD and  ND shoots, and in the sandpit  the colonizing plant shows
intensive  lateral branching  due to  favorable light  conditions.  An
outline  of the  L  system  is given  in  Appendix \ref{sec:L2}.   For
details see \citet{salemaa:02}.

The  collision detection  algorithm  of LIGNUM  simply examines  given
opening angle symmetrical  to both sides of the  growth direction of a
bud and  checks whether it is free  of other shoots and  buds within a
given distance.  More precisly, define $\vec {P_1}$ as the position of
the bud and $\vec D$ as  its growth direction.  Define $\vec {P_2}$ as
the position of the potential  obstacle. Then $\vec {P_3} = \vec {P_2}
- \vec {P_1}$  is the direction from  the bud to  the obstacle.  Given
the opening angle $\alpha$ and  the distance $l$, the obstacle hinders
the growth of the bud  if $\cos(\alpha/2) = \frac{{\vec D} \cdot {\vec
{P_3}}} {|\vec D||\vec {P_3}|}$ and $|\vec {P_3}| < l$.

Investigation of whether a bud collides with another plant compartment
is implemented as a pairwise comparison of structural units in LIGNUM,
i.e.   not  by  rewriting the  rules  in  L  language.  The  value  of
parameter   $C$    in   the    module   $B$   is    updated   (Section
\ref{sec:LignumToL})   using  the   result   of  collision   detection
calculations  in  LIGNUM.   The  results  of the  development  of  the
bearberry  model after  15 iterations  with three  different collision
models  are presented  in  Fig.  \ref{fig:a-uva-ursi}.   As one  would
expect,  the  bearberry  models   show  less  lateral  branching  with
increasing opening angle for collision detection.
 

















